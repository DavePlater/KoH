<html>
<head>
<title>KoH Monster Brew</title>
<meta charset="UTF-8">
<meta name="author" content="KingPlater" />
<meta name="description" content="https://daveplater.github.io/KoH/MonsterBrew.html" />
<style type="text/css">
	.CurrentQuest { font-weight:bold; color:red;}
	#tblQuestReqs td { text-align:center;}
</style>
<script type="text/javascript">

	// not to self: Include a table giving the "1/2/3 star" reqs for each quest in each bracket? hmm
	// store what TH you want to "math" as and then you QuestReqs to look up?
var QuestReqs = 
{
	THBrackets:
	[ 
		{Min:23, Max:25, Quests:{DragonQuest:[664000 , 1327000 , 4117000], SlayerQuest:[]} },
		{Min:19, Max:22, Quests:{DragonQuest:[371000, 882,000, 2540000], SlayerQuest:[]}	},
		{Min:16, Max:18, Quests:{DragonQuest:[324000,753000,2179000], SlayerQuest:[]}	},
		{Min:13, Max:15, Quests:{DragonQuest:[240000,587000,882000], SlayerQuest:[]}	},
		{Min:10, Max:12, Quests:{DragonQuest:[], SlayerQuest:[]}	},
		{Min:07, Max:09, Quests:{DragonQuest:[], SlayerQuest:[]}	},
		{Min:04, Max:06, Quests:{DragonQuest:[], SlayerQuest:[]}	},
		{Min:01, Max:03, Quests:{DragonQuest:[], SlayerQuest:[]}	}
	],
	getBracket:function(THLevel) //loop through THBrackets and find where >=min and <= Max
	{ 
		var retval={};
		var iTHLevel = parseInt(THLevel);
		for(var i=0;i<this.THBrackets.length;i++)		{			if(iTHLevel >= this.THBrackets[i].Min && iTHLevel <= this.THBrackets[i].Max){retval=this.THBrackets[i]; break;}		}
		return retval;
	}
	
};

var PointValues =
{
	SlayerQuest: {Name:"Slayer Quest", MonsterHit:250, MonsterKill:1250, TitanHit:1500, TitanKill:45000},
	DailyClan:{Name:"Daily Clan Quest", MonsterHit:500, MonsterKill:2500, TitanHit:3000, TitanKill:90000},
	DragonQuest:{Name:"Dragon Quest", MonsterHit:3250, MonsterKill:16250, TitanHit:19500, TitanKill:585000},
	AllYouCanSlay:{Name:"All You Can Slay Quest", MonsterHit:3250, MonsterKill:16250, TitanHit:19500, TitanKill:585000}
};
var oActivePointList=PointValues["SlayerQuest"];

	function sHTML(strID,strHTML)	{		var o=document.getElementById(strID);		if(o!=undefined)		{			o.innerHTML=strHTML;		}	}
	function sCB(strID, bChecked){var o=document.getElementById(strID);		if(o!=undefined)		{	o.checked =bChecked;}	}
	function sV(strID,strValue)	{		var o=document.getElementById(strID);		if(o!=undefined)		{			o.value=strValue;		}	}
	function gCB(strID)	{		var retval=false;		var o=document.getElementById(strID);		if(o!=undefined)		{			retval=o.checked;		}		return retval;	}
	function gV(strID)	{		var retval="";		var o=document.getElementById(strID);		if(o!=undefined)		{			retval=o.value;		}		return retval;	}
	
	function QuestReqsToTable(THLevelToGet)
	{
		var oBracket=QuestReqs.getBracket(THLevelToGet);
		var tblQuestReqs=document.getElementById("tblQuestReqs");
		if(oBracket!=undefined) //it never should but whatever...
		{
			while(tblQuestReqs.tBodies.length>0)			{				tblQuestReqs.removeChild(tblQuestReqs.tBodies[0]);			} //clear TBODIES
			var str="";
			str+="<tr><th width=\"33%\">Bracket</th><td>"+oBracket["Min"]+"</td><td>"+oBracket["Max"]+"</td></tr>\r\n";
			var oQuests=oBracket["Quests"];
			for (var oQ in oQuests) 
			{
				str+="<tr><th colspan=\"3\">"+oQ+"</th></tr>\r\n";
				if(oQuests[oQ].length==3)
				{str+="<tr><td>"+oQuests[oQ][0].toLocaleString()+"</td><td>"+oQuests[oQ][1].toLocaleString()+"</td><td>"+oQuests[oQ][2].toLocaleString()+"</td></tr>\r\n";}
				else {str+="<tr><td colspan=\"3\">??</td></tr>";}
  		}
			var newBody=document.createElement ("tbody");
			newBody.id="tbody_"+THLevelToGet;
			newBody.innerHTML=str;
			
			tblQuestReqs.appendChild(newBody);			
		}
	}
	function PointListToTable(strPointValueObjectName)
	{
		var oPointList = PointValues[strPointValueObjectName];
		var tblPointListings=document.getElementById("tblPointListings");
		if(tblPointListings!=undefined && oPointList!=undefined)
		{
			var str="";
			str+="<tr><th colspan=\"3\">"+oPointList["Name"]+"</th><td><button onclick=\"btQuestSelect_Click('"+strPointValueObjectName+"')\">Select</button></td></tr>\r\n";
			str+="<tr><th>Monster Hit</th><td>"+oPointList["MonsterHit"]+"</td><th>Monster Kill</th><td>"+oPointList["MonsterKill"]+"</td></tr>\r\n";
			str+="<tr><th>Titan Hit</th><td>"+oPointList["TitanHit"]+"</td><th>Titan Kill</th><td>"+oPointList["TitanKill"]+"</td></tr>\r\n";
			var newBody=document.createElement ("tbody");
			newBody.id="tbody_"+strPointValueObjectName;
			newBody.innerHTML=str;
			
			tblPointListings.appendChild(newBody);			
		}	
	}
	
	function ClearTBODYColors()
	{
		var tblPointListings=document.getElementById("tblPointListings");
		if(tblPointListings!=undefined)
		{
			for(var i=0; i< tblPointListings.tBodies.length;i++ )			{				tblPointListings.tBodies[i].style.backgroundColor="white";			}
		}
	}
	
	function btQuestSelect_Click(strPointValueObjectName)
	{//this is a dumb way to do this:
		
		var oPointList = PointValues[strPointValueObjectName];
		if(oPointList!=undefined)		{			oActivePointList=oPointList;		localStorage.setItem("WhichQuest", strPointValueObjectName);	}
		//
		ClearTBODYColors();
		var tbody=document.getElementById("tbody_"+strPointValueObjectName);
		if(tbody!=undefined)		{			tbody.style.backgroundColor = "red";		}
	}
	function FillInFieldsFromStorage()
	{
		if (typeof(Storage) !== "undefined") 
		{
			var strPointValueObjectName=(localStorage.getItem("WhichQuest")||"SlayerQuest");//default to SlayerQuest
			var iLevel= (localStorage.getItem("MonsterLevel")||1);//default 1
	  	var iHits = (localStorage.getItem("NumberHits")||0);//default 0
	  	var bBonus = (localStorage.getItem("Bonus")||false);//default false
	  	window.myTHLevel = (localStorage.getItem("THLevel")||15);//default 15
	  	sV("tbTHNumber",window.myTHLevel);
	  	sV("ddlMonsterLevel",iLevel);
	  	sV("tbNumAttacks",iHits);
	  	sCB("cbKillAlsoGetsHit",bBonus);
	  	//		
			btQuestSelect_Click(strPointValueObjectName); 
		}
	}
	function SaveFieldsToStorage()
	{
		if (typeof(Storage) !== "undefined") 
		{
			var iLevel=parseInt(gV("ddlMonsterLevel"));
			var iHits=parseInt(gV("tbNumAttacks"));
			var bBonus=gCB("cbKillAlsoGetsHit");
			var iTHLevel = (window.myTHLevel||15);
    	localStorage.setItem("MonsterLevel", iLevel);
    	localStorage.setItem("NumberHits", iHits);
    	localStorage.setItem("Bonus", bBonus);
    	localStorage.setItem("THLevel", iTHLevel);
		} 
		else 
		{
		    // Sorry! No Web Storage support..
		}
	}
	
	function bodyLoad()
	{
		PointListToTable("SlayerQuest");
		PointListToTable("DailyClan");
		PointListToTable("DragonQuest");
		//PointListToTable("AllYouCanSlay");
		//
		FillInFieldsFromStorage();		
		//
		QuestReqsToTable(window.myTHLevel);
	}
	
	function btCalculate_click()
	{
		SaveFieldsToStorage();
		var strResult="";
		var iMH=oActivePointList.MonsterHit;
		var iMK=oActivePointList.MonsterKill;
		var iLevel=parseInt(gV("ddlMonsterLevel"));
		var iHits=parseInt(gV("tbNumAttacks"));
		var strBonus=gCB("cbKillAlsoGetsHit");
		strResult+="["+oActivePointList.Name+"]\r\n";
		strResult+="Level: "+iLevel+", ";
		strResult+="Hits: "+iHits+", ";
		strResult+="Bonus: "+strBonus+"\r\n";
		strResult+"\r\n";
		
		var pts=(iLevel*iMH)*(iHits-1);
		pts+=(iLevel*iMK);
		if(strBonus==true)
		{
			pts+=(iLevel*iMH);
		}
		strResult+="Points: "+pts+"\r\n";
		sV("tbOutput",strResult);

		
	}
	function btSetTHclick()
	{
		var iTHNumber=parseInt(gV("tbTHNumber"));
		window.myTHLevel=iTHNumber;
		SaveFieldsToStorage();
		QuestReqsToTable(window.myTHLevel);
	}
	
</script>
</head>
<body onload="bodyLoad();">
	
	<table id="tblBig" border="0" cellspacing="2" cellpadding="5" >
		<tr>
			<td valign="top"><table id="tblPointListings" border="1" cellspacing="2" cellpadding="5">	</table></td>
			<td valign="top">
				
				<table id="tblQuestReqs" border="1" cellspacing="2" cellpadding="5" style="min-width:400px;">	
					<thead>
							<tr><th>TH</th><td colspan="2"><input type="text" id="tbTHNumber" /> <button id="btSetTH" onclick="btSetTHclick()">Set</button></td></tr>
					</thead>
				</table>
			</td>
		</tr>
	</table>
	
<br/>
<div>
	
	Monster Level:
	<select id="ddlMonsterLevel">
  	<option value="1">Level 1</option>
  	<option value="2">Level 2</option>
  	<option value="3">Level 3</option>
  	<!-- -->
  	<option value="4">Level 4</option>
  	<option value="5">Level 5</option>
  	<option value="6">Level 6</option>
  	<!-- -->
  	<option value="7">Level 7</option>
  	<option value="8">Level 8</option>
  	<option value="9">Level 9</option>  	
	</select> 
	<br/>
	Number of Attacks: <input type="text" id="tbNumAttacks" /><br/>
	<label>Does my last attack get points for kill AND hit? <input type="checkbox" id="cbKillAlsoGetsHit"/></label><br/>
	<br/>
	<button id="btCalculate" onclick="btCalculate_click()">Calculate</button>
	<br/>
	<br/>
	<br/>
	<textarea id="tbOutput" cols="48" rows="12"></textarea>
</div>
</body>
</html>

